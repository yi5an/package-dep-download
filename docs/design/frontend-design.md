# å‰ç«¯è®¾è®¡

## é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”§ ç¦»çº¿è½¯ä»¶åŒ…ä¸‹è½½å·¥å…·                      [ä»»åŠ¡å†å²] [è®¾ç½®] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. é€‰æ‹©ç³»ç»Ÿç±»å‹                                    â”‚ â”‚
â”‚  â”‚  â—‹ RPM  â—‹ DEB                                      â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚  2. é€‰æ‹©å‘è¡Œç‰ˆå’Œæ¶æ„                               â”‚ â”‚
â”‚  â”‚  [CentOS 8 â–¼] [x86_64 â–¼]                          â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚  3. è¾“å…¥åŒ…å                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ nginx, python3, redis                        â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚  [ğŸ” æœç´¢åŒ…]  [ğŸ“‹ æ‰¹é‡å¯¼å…¥]  [ğŸ“¦ é¢„è®¾æ¨¡æ¿]         â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚  4. é«˜çº§é€‰é¡¹                                       â”‚ â”‚
â”‚  â”‚  â˜‘ é€’å½’ä¸‹è½½æ‰€æœ‰ä¾èµ–                                â”‚ â”‚
â”‚  â”‚  â˜‘ åŒ…å«æ¨èåŒ…                                      â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚           [ğŸš€ å¼€å§‹ä¸‹è½½]                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ“¥ ä¸‹è½½è¿›åº¦                                        â”‚ â”‚
â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  75%           â”‚ â”‚
â”‚  â”‚  æ­£åœ¨ä¸‹è½½: openssl-libs-1.1.1k (3/12)              â”‚ â”‚
â”‚  â”‚  å·²ä¸‹è½½: 45.2 MB / 120.5 MB                        â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚  æ—¥å¿—:                                             â”‚ â”‚
â”‚  â”‚  [15:30:22] å¼€å§‹è§£æä¾èµ–...                         â”‚ â”‚
â”‚  â”‚  [15:30:25] æ‰¾åˆ° 12 ä¸ªä¾èµ–åŒ…                        â”‚ â”‚
â”‚  â”‚  [15:30:26] å¼€å§‹ä¸‹è½½...                             â”‚ â”‚
â”‚  â”‚  [15:30:28] ä¸‹è½½å®Œæˆ: nginx-1.20.1                 â”‚ â”‚
â”‚  â”‚  [15:30:30] ä¸‹è½½å®Œæˆ: openssl-libs-1.1.1k          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  æœ€è¿‘ä»»åŠ¡                                           â”‚ â”‚
â”‚  â”‚  âœ… nginx (CentOS 8) - 2024-02-06 15:30 - [ä¸‹è½½]    â”‚ â”‚
â”‚  â”‚  âœ… docker-ce (CentOS 8) - 2024-02-06 14:20 - [ä¸‹è½½]â”‚ â”‚
â”‚  â”‚  âŒ mysql-server (Ubuntu 22) - 2024-02-06 13:10     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. åŒ…è¾“å…¥ç»„ä»¶

```javascript
class PackageInput {
    constructor(container) {
        this.container = container;
        this.packages = [];
        this.init();
    }

    init() {
        // æ ‡ç­¾è¾“å…¥æ¡†
        this.render();
        this.bindEvents();
    }

    addPackage(name) {
        if (!this.packages.includes(name)) {
            this.packages.push(name);
            this.render();
        }
    }

    removePackage(index) {
        this.packages.splice(index, 1);
        this.render();
    }

    render() {
        this.container.innerHTML = `
            <div class="package-tags">
                ${this.packages.map((pkg, i) => `
                    <span class="tag">
                        ${pkg}
                        <button onclick="removePackage(${i})">Ã—</button>
                    </span>
                `).join('')}
            </div>
            <input type="text" placeholder="è¾“å…¥åŒ…ååå›è½¦..."
                   onkeypress="handleKeyPress(event)">
        `;
    }
}
```

### 2. åŒ…æœç´¢ç»„ä»¶

```javascript
class PackageSearch {
    constructor(systemType, distribution) {
        this.systemType = systemType;
        this.distribution = distribution;
    }

    async search(query) {
        const response = await fetch(
            `/api/search?type=${this.systemType}&dist=${this.distribution}&q=${query}`
        );
        return await response.json();
    }

    renderSuggestions(packages) {
        return packages.map(pkg => `
            <div class="suggestion-item" onclick="selectPackage('${pkg.name}')">
                <strong>${pkg.name}</strong> - ${pkg.summary}
                <small>${pkg.version}</small>
            </div>
        `).join('');
    }
}
```

### 3. è¿›åº¦æ˜¾ç¤ºç»„ä»¶

```javascript
class DownloadProgress {
    constructor(taskId) {
        this.taskId = taskId;
        this.eventSource = null;
    }

    start() {
        this.eventSource = new EventSource(`/api/events/${this.taskId}`);

        this.eventSource.onmessage = (event) => {
            const data = JSON.parse(event.data);
            this.update(data);
        };

        this.eventSource.onerror = () => {
            this.showError('è¿æ¥æ–­å¼€');
        };
    }

    update(data) {
        document.getElementById('progress-bar').style.width = `${data.progress}%`;
        document.getElementById('progress-text').textContent = `${data.progress}%`;
        document.getElementById('status-message').textContent = data.message;

        // æ›´æ–°æ—¥å¿—
        if (data.log) {
            this.addLog(data.log);
        }

        // å®Œæˆåè‡ªåŠ¨ä¸‹è½½
        if (data.status === 'completed') {
            this.autoDownload(data.download_url);
        }
    }

    autoDownload(url) {
        const a = document.createElement('a');
        a.href = url;
        a.download = '';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }

    stop() {
        if (this.eventSource) {
            this.eventSource.close();
        }
    }
}
```

### 4. ä»»åŠ¡åˆ—è¡¨ç»„ä»¶

```javascript
class TaskList {
    constructor() {
        this.tasks = [];
        this.load();
        this.startAutoRefresh();
    }

    async load() {
        const response = await fetch('/api/tasks');
        const data = await response.json();
        this.tasks = data.tasks;
        this.render();
    }

    render() {
        const container = document.getElementById('task-list');
        container.innerHTML = this.tasks.map(task => `
            <div class="task-item ${task.status}">
                <div class="task-header">
                    <span class="task-name">${task.packages.join(', ')}</span>
                    <span class="task-meta">
                        ${task.system_type} - ${task.distribution}
                    </span>
                </div>
                <div class="task-status">
                    ${this.getStatusIcon(task.status)}
                    ${task.message}
                </div>
                ${task.status === 'completed' ? `
                    <button onclick="downloadFile('${task.task_id}')">
                        ä¸‹è½½å‹ç¼©åŒ…
                    </button>
                ` : ''}
            </div>
        `).join('');
    }

    getStatusIcon(status) {
        const icons = {
            'pending': 'â³',
            'running': 'ğŸ”„',
            'completed': 'âœ…',
            'failed': 'âŒ'
        };
        return icons[status] || 'â“';
    }

    startAutoRefresh() {
        setInterval(() => this.load(), 5000); // 5ç§’åˆ·æ–°
    }
}
```

## CSS æ ·å¼è®¾è®¡

```css
:root {
    --primary-color: #2563eb;
    --success-color: #10b981;
    --error-color: #ef4444;
    --bg-color: #f8fafc;
    --border-color: #e2e8f0;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: var(--bg-color);
    margin: 0;
    padding: 20px;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
}

.card {
    background: white;
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 20px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* æ ‡ç­¾è¾“å…¥ */
.package-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 12px;
}

.tag {
    background: #dbeafe;
    padding: 4px 12px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.tag button {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 18px;
    color: #6b7280;
}

/* è¿›åº¦æ¡ */
.progress-container {
    background: #e5e7eb;
    height: 24px;
    border-radius: 12px;
    overflow: hidden;
    margin: 16px 0;
}

.progress-bar {
    background: var(--primary-color);
    height: 100%;
    transition: width 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 12px;
}

/* æ—¥å¿— */
.log-container {
    background: #1f2937;
    color: #f3f4f6;
    padding: 16px;
    border-radius: 8px;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    max-height: 300px;
    overflow-y: auto;
}

.log-entry {
    margin: 4px 0;
    padding-left: 12px;
    border-left: 2px solid #6b7280;
}

/* ä»»åŠ¡åˆ—è¡¨ */
.task-item {
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 12px;
}

.task-item.completed {
    border-left: 4px solid var(--success-color);
}

.task-item.failed {
    border-left: 4px solid var(--error-color);
}

/* å“åº”å¼ */
@media (max-width: 768px) {
    .container {
        padding: 12px;
    }

    .card {
        padding: 16px;
    }
}
```

## API äº¤äº’å°è£…

```javascript
class API {
    static async download(request) {
        const response = await fetch('/api/download', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(request)
        });
        return await response.json();
    }

    static async getTasks() {
        const response = await fetch('/api/tasks');
        return await response.json();
    }

    static async getTask(taskId) {
        const response = await fetch(`/api/tasks/${taskId}`);
        return await response.json();
    }

    static async deleteTask(taskId) {
        const response = await fetch(`/api/tasks/${taskId}`, {
            method: 'DELETE'
        });
        return await response.json();
    }

    static async searchPackages(type, dist, query) {
        const response = await fetch(
            `/api/packages?type=${type}&dist=${dist}&q=${query}`
        );
        return await response.json();
    }
}
```

## ä¸»åº”ç”¨é€»è¾‘

```javascript
class App {
    constructor() {
        this.packageInput = new PackageInput(document.getElementById('package-input'));
        this.taskList = new TaskList();
        this.currentProgress = null;
    }

    async startDownload() {
        const request = {
            packages: this.packageInput.packages,
            system_type: document.getElementById('system-type').value,
            distribution: document.getElementById('distribution').value,
            arch: document.getElementById('arch').value,
            deep_download: document.getElementById('deep-download').checked
        };

        try {
            const result = await API.download(request);

            // æ˜¾ç¤ºè¿›åº¦
            this.currentProgress = new DownloadProgress(result.task_id);
            this.currentProgress.start();

            // åˆ·æ–°ä»»åŠ¡åˆ—è¡¨
            this.taskList.load();

        } catch (error) {
            alert('ä¸‹è½½å¤±è´¥: ' + error.message);
        }
    }
}

// åˆå§‹åŒ–åº”ç”¨
document.addEventListener('DOMContentLoaded', () => {
    window.app = new App();
});
```

## é¢„è®¾æ¨¡æ¿åŠŸèƒ½

```javascript
const TEMPLATES = {
    'web-server': {
        name: 'Web æœåŠ¡å™¨',
        packages: ['nginx', 'openssl'],
        description: 'åŒ…å« Nginx åŠå…¶ä¾èµ–'
    },
    'docker': {
        name: 'Docker å®¹å™¨',
        packages: ['docker-ce', 'docker-ce-cli', 'containerd.io'],
        description: 'å®Œæ•´çš„ Docker å®¹å™¨ç¯å¢ƒ'
    },
    'development': {
        name: 'å¼€å‘å·¥å…·',
        packages: ['git', 'vim', 'python3', 'nodejs', 'gcc'],
        description: 'å¸¸ç”¨çš„å¼€å‘å·¥å…·é›†'
    }
};

function applyTemplate(templateId) {
    const template = TEMPLATES[templateId];
    window.app.packageInput.packages = [...template.packages];
    window.app.packageInput.render();
}
```

è¿™éƒ¨åˆ†å‰ç«¯è®¾è®¡æ˜¯å¦æ»¡è¶³éœ€æ±‚?
